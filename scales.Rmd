# (PART) Scales {-}

# Introduction {#scales .unnumbered}

```{r setup, include = FALSE}
source("common.R")
columns(1, 2 / 3)
```

\index{Scales}

Scales in ggplot2 control the mapping from data to aesthetics. They take your data and turn it into something that you can see, like size, colour, position or shape. They also provide the tools that let you interpret the plot: the axes and legends. You can generate plots with ggplot2 without knowing how scales work, but understanding scales and learning how to manipulate them will give you much more control.

In ggplot2, guides are produced automatically based on the layers in your plot. You don't directly control the legends and axes; instead you set up the data so that there's a clear mapping between data and aesthetics, and a guide is generated for you. This is very different to base R graphics, where you have total control over the legend, and can be frustrating when you first start using ggplot2. However, once you get the hang of it, you'll find that it saves you time, and there is little you cannot do.

Scales serve two related roles. First, they construct a mapping from a region in the data space to a region in the aesthetic space (i.e., positions, colours, etc). Second, they govern the axis and legend of the plot, the visual guides that tell the reader how to interpret the observable features of the plot. You might find it surprising that axes and legends are the same type of thing, but while they look very different they have the same purpose: to allow you to read observations from the plot and map them back to their original values. 

| Argument name   | Axis              | Legend        
|:----------------|:------------------|:--------------
| `name`          | Label             | Title         
| `breaks`        | Ticks & grid line | Key           
| `labels`        | Tick label        | Key label     

```{r guides, echo = FALSE, out.width = "100%", fig.cap = "Common components of axes and legends"}
knitr::include_graphics("diagrams/scale-guides.png", dpi = 300, auto_pdf = TRUE)
```


Every aesthetic in your plot is associated with exactly one scale. For instance, when you write:

```{r default-scales, fig.show = "hide"}
ggplot(mpg, aes(displ, hwy)) + 
  geom_point(aes(colour = class))
```

ggplot2 adds a default scale for each aesthetic used in the plot: 

```{r, fig.show = "hide"}
ggplot(mpg, aes(displ, hwy)) + 
  geom_point(aes(colour = class)) +
  scale_x_continuous() + 
  scale_y_continuous() + 
  scale_colour_discrete()
```

The choice of default scale depends on the aesthetic and the variable type. In this example `hwy` is a continuous variable mapped to the y aesthetic so the default scale is `scale_y_continuous()`; similarly `class` is discrete so when mapped to the colour aesthetic the default scale becomes `scale_colour_discrete()`. 

Specifying these defaults would be tedious so ggplot2 does it for you. But if you want to override the default scales, you'll need to add the scale yourself, like this: \index{Scales!defaults}

```{r, fig.show = "hide"}
ggplot(mpg, aes(displ, hwy)) + 
  geom_point(aes(colour = class)) +
  scale_x_sqrt() + 
  scale_colour_brewer()
```

Here `scale_x_sqrt()` modifies the scale associated with the x axis, and `scale_colour_brewer()` does the same for colour. Because the role of the scale functions is to modify scales, the use of `+` to "add" scales to a plot can be a little misleading: when you `+` a scale, you're not actually adding it to the plot, but overriding the existing scale. If you supply two scales for the same aesthetic, the last scale takes precedence. This means that the following two specifications are equivalent: \indexc{+} 

```{r multiple-scales, fig.show = "hide"}
ggplot(mpg, aes(displ, hwy)) + 
  geom_point(aes(colour = class)) +
  scale_colour_viridis_d() +
  scale_colour_brewer()

ggplot(mpg, aes(displ, hwy)) + 
  geom_point(aes(colour = class)) +
  scale_colour_brewer()
```

Note the message when you add multiple scales for the same aesthetic, which makes it harder to accidentally overwrite an existing scale. If you see this in your own code, you should make sure that you're only adding one scale to each aesthetic.

The scale functions follow a common naming scheme. You've probably already figured out the scheme, but to be concrete, it's made up of three pieces separated by "_":

1. `scale`
1. The name of the primary aesthetic (e.g., `colour`, `shape` or `x`)
1. The name of the scale (e.g., `continuous`, `discrete`, `brewer`).

Scales work similarly for all aesthetics, but there are enough differences that it helps to divide them into three groups and cover each group in a separate chapter: 

* Position scales and axes are covered in Chapter \@ref(scale-position)
* Colour scales and legends are covered in Chapter \@ref(scale-colour)
* Other scales for non-position aesthetics are covered in Chapter \@ref(scale-other)



